---
title: "Reproducibilidad"
subtitle: "XII Congreso Colombiano de Botánica"
author:
  - name: "Álex Espinosa Correa"
    affiliation: "Universidad de Antioquia"
  - name: "Bladimir Vera Marín"
    affiliation: "Universidad de Antioquia"
# date: 2024-11-02

format: 
  revealjs:
    theme:
      - simple
      - ../../custom.scss
    width: 1920
    height: 1080
    embed-resources: true
    slide-number: true
    preview-links: true
    controls: true
    touch: false
    # chalkboard: true
    code-block-height: 850px
    logo: "https://github.com/geobota/geobota.github.io/blob/main/images/xii-ccb/xii-ccb-logo.png?raw=true"
    footer: "[Etnobotánica Cuantitativa en R](https://geobota.github.io/xii-ccb-etnobotanica/)"
bibliography: references.bib
csl: apa.csl
---

```{r}
#| label: setup
#| output: false

if (!require("here")) install.packages("here"); library("here")
if (!require("fontawesome")) install.packages("fontawesome"); library("fontawesome")
```

```{r}
#| label: countdown
#| echo: false
#| 
countdown_timer <- function(
    minutes = 1, 
    play_sound = TRUE, 
    font_size = "2em", 
    ...
) {
  countdown::countdown(
    minutes = minutes,
    play_sound = play_sound,
    color_border              = "#white",
    color_text                = "white",
    color_running_background  = "#009E73",
    color_running_text        = "white",
    color_finished_background = "#D55E00",
    color_finished_text       = "white",
    font_size = font_size,
    ...
  )
}
```

## Proposito {.incremental}

-   Mostrar la importancia de la reproducibilidad en la ciencia
-   Enseñar a manejar los proyectos de RStudio
-   Enseñar a manejar las rutas relativas
-   Enseñar la importancia de los nombres
-   Dar una introducción al control de versiones

## ¿Estamos en crisis? 

::: columns
::: {.column width="50%"}
![Respuesta de 1576 cientificos a @baker2016](images/crisis_01.jpeg){fig-align="center"}
:::

::: {.column width="50%"}
::: {layout-ncol=1}
![Registros de WoS que en el título, resumen o palabras clave contienen: «crisis de reproducibilidad», «crisis científica», «ciencia en crisis», «crisis en la ciencia», «crisis de replicación», o «crisis de replicabilidad». @fanelli2018](images/crisis_grafica.jpeg){fig-align="center"}

![246 biólogo obtiene 256 resultados diferentes. ](images/crisis_articulo.png){fig-align="center"}
:::
:::
:::

## ¿Alguien por favor quiere pensar en los biólogos?

![@baker2016](images/crisis_02.jpeg){fig-align="center"}

## Sí, necesitamos un cambio

::: columns
::: {.column width="50%"}
:::

::: {.column width="50%"}
:::
:::
![@korbmacher2023](images/cambios.png){fig-align="center"}

## Ciencia abierta

::: columns
::: {.column width="60%"}
>[«Constructo inclusivo que combina diversos movimientos y prácticas con el fin de que los conocimientos científicos multilingües estén abiertamente disponibles y sean accesibles para todos, así como reutilizables por todos, se incrementen las colaboraciones científicas y el intercambio de información en beneficio de la ciencia y la sociedad, y se abran los procesos de creación, evaluación y comunicación de los conocimientos científicos a los agentes sociales más allá de la comunidad científica tradicional.]{.fragment} [La ciencia abierta comprende todas las disciplinas científicas y todos los aspectos de las prácticas académicas, incluidas las ciencias básicas y aplicadas, las ciencias naturales y sociales y las humanidades, y se basa en los siguientes pilares clave: conocimiento científico abierto, infraestructuras de la ciencia abierta, comunicación científica, participación abierta de los agentes sociales y diálogo abierto con otros sistemas de conocimiento.» @unesco2021]{.fragment}
:::

::: {.column .fragment width="40%"}
![Algunos beneficios de la ciencia abierta. @unesco2021](images/ciencia-abierta_definicion.png){fig-align="center"}
:::
:::

::: {.footer}
[Política Nacional De Ciencia Abierta 2022-2031, Resolución 0777 del 2022](https://redcol.minciencias.gov.co/Content/ciencia_abierta)
:::

## Valores fundamentales y principios rectores

![Valores fundamentales y principios rectores de la ciencia abierta. @unesco2021](images/ciencia-abierta_valores_principios.png){fig-align="center"}

## Taxonomía de la ciencia abierta

::: {.r-stack}

![](images/ciencia-abierta_taxonomia.png){.fragment .fade-out fig-align="center"}

![](images/ciencia-abierta_taxonomia_zoom.png){.fragment fig-align="center"}
:::

::: {.footer}
Imagen original [@dasilveira2023], <https://zenodo.org/records/7858978>. FAIR: **F**indable, **A**ccessible, **I**nteroperable, **R**eusable.
:::

## Investigación abierta reproducible

::: columns
::: {.column width="50%"}
> [Reproducibilidad significa que los datos y el código de investigación están disponibles para que otros sean capaces de obtener los mismos resultados alcanzados en sus trabajos. Este concepto está íntimamente relacionado con el de replicabilidad, el acto de repetir una metodología científica con el objetivo de alcanzar conclusiones similares. Estos conceptos son elementos centrales de la investigación empírica.]{.fragment}
>
> [Mejorar la reproducibilidad conduce a aumentar el rigor y la calidad de los trabajos científicos y, por tanto, a una mayor confianza en la ciencia. @bezjak2018]{.fragment}
:::

::: {.column .fragment width="50%"}
![La reproducibilidad se aplica directamente al método científico. @bezjak2018](images/ciencia_metodo.png){fig-align="center"}
:::
:::

## Repetibilidad, Replicabilidad, Reproducibilidad, y otras erres

::: {.fragment}
|            @goodman2016            |  @claerbout1992  | @associationforcomputingmachineryacm2020 |
|:------------------------:|:---------------:|:---------------------------:|
|                                    |                  |              Repetibilidad               |
|  Reproducibilidad de los métodos   | Reproducibilidad |              Replicabilidad              |
| Reproducibilidad de los resultados |  Replicabilidad  |             Reproducibilidad             |
|    Reproducibilidad inferencial    |                  |                                          |

: Comparación de términos. Traducido de @plesser2018.
:::

::: {.fragment}
![Explicación de la terminología sobre reproducibilidad y replicabilidad. @whitaker2017.](images/reproducible-matrix.jpg){fig-align="center"}
:::

## El espectro de la reproducibilidad

::: {layout-ncol=1}
::: {.fragment}
![Espectro de reproducibilidad más común. @peng2011.](images/reproducibility_spectrum_1.png){fig-align="center"}
:::

::: {.fragment}
![Compartir datos y código se considera suficiente para que muchos reproduzcan el análisis de datos. Sin embargo, esto no es suficiente. @akalin2021.](images/reproducibility_spectrum_2.png){fig-align="center"}
:::
:::

## Cómo fomentar la investigación abierta reproducible

![Estrategias para hacer de la investigación reproducible y la formación en ciencia abierta la norma en las instituciones de investigación. @kohrs2023](images/ciencia-abierta_once-estrategias.jpg){fig-align="center"}

## Entorno de desarrollo integrado (IDE)

# `r fontawesome::fa("laptop-code", "white")` Actividad {background-color="#0072B2" transition="slide-in"}

-   Abrir `script_super-analisis.r` que se encuentra en la carpeta `reproducibilidad`
-   Ejecutar el script

<br>

<br>

```{r}
#| label: timer-1
#| echo: false

countdown_timer(5)
```

## Advertencia

::: {.fragment .r-fit-text}
Si la primera línea de tu script R es

`setwd("C:\Users\jenny\ruta\que\solo\yo\tengo")`

Iré a tu oficina y LE PRENDERÉ FUEGO A TU ORDENADOR 🔥

*Jenny Bryan*
:::

::: columns
::: {.column .fragment width="50%"}
![`r fontawesome::fa("mastodon")` [\@jennybryan\@fosstodon.org](https://fosstodon.org/@jennybryan)](images/jenny_bryan.jpeg)

:::

::: {.column .fragment width="50%"}
-   Científica de datos y profesora asociada de estadística en la Universidad de Columbia Británica. Estadista e ingeniera de software en Posit.
-   Autora de [*Happy Git and GitHub for the useR*](https://happygitwithr.com), [*What they gorgot to teach you about R*](https://rstats.wtf), [*STAT 545: Data wrangling, exploration, and analysis with R*](http://stat545.com).
-   Autora y responsable de `reprex`, `readxl`, `googlesheets4`, `usethis`, entre otros. 
:::
:::

## El problema con `setwd()`

## Proyectos

::: incremental
-   Un proyecto es una carpeta que contiene todos los archivos relevantes para un trabajo en particular.

-   Los proyectos permiten que las investigaciones sean reproducibles, portátiles y autocontenibles.

-   Trabajar con proyectos implica tener:

    -   **disciplina en el sistema de archivos**: todos los archivos relacionados a un proyecto (datos, imágenes, resultados, scripts, etc) están en la carpeta del proyecto.
    -   **intencionalidad en el directorio de trabajo**: siempre se trabaja en el directorio del proyecto.
    -   **disciplina en las rutas de archivos**: todas las rutas son relativas (nunca absolutas) y relativas a la carpeta del proyecto.
:::

::: footer
[Más información](https://rstats.wtf/projects)
:::

## Proyectos de RStudio

![Hay varias formas de crear un proyecto. La más sencilla es `File` \> `New Project`.](images/rstudio_projects.png){fig-align="center"}

::: footer
[Más información](https://docs.posit.co/ide/user/ide/guide/code/projects.html)
:::

## Configuración de RStudio

Siempre es recomendable trabajar en un workspace nuevo, así como reiniciar R de vez en cuando.

![Para desactivar `.Rdata` ir a `Tools` \> `Global Options`.](images/rstudio_workspace.png){fig-align="center"}

::: footer
[Más información](https://rstats.wtf/source-and-blank-slates#always-start-r-with-a-blank-slate)
:::

## Rutas

::: columns
::: {.column width="50%"}
### Rutas absolutas

Indican la ubicación de un archivo o directorio desde el directorio raíz del sistema de archivos. Dificulta la reproducibilidad ya que esa ruta sólo «funciona» en el equipo donde se haya creado.

::: {style="font-size: 70px"}
    /usuarios/yo/documentos/r/proyecto/scripts/super-analisis.R
:::

### Rutas relativas

Indican la ubicación de un archivo o directorio a partir de la posición actual del sistema operativo en el sistema de archivos.

::: {style="font-size: 70px"}
    /scripts/super-analisis.R
:::
:::

::: {.column width="50%"}
![[Allison Horst](https://allisonhorst.com/r-packages-functions).](images/package_here.jpg){fig-align="center"}
:::
:::

## You are `here::here()`

## Rutas en Quarto

## El nombre de las cosas

### No {.fragment fragment-index="1"}

::: {.fragment fragment-index="1" style="font-size: 70px"}
    myabstract.docx
    Joe’s Filenames Use Spaces and Punctuation.xlsx
    figure 1.png
    fig 2.png
    JW7d^(2sl@deletethisandyourcareerisoverWx2*.txt
:::

### Sí {.fragment fragment-index="2"}

::: {.fragment fragment-index="2" style="font-size: 70px"}
    2014-06-08_abstract-for-sla.docx
    joes-filenames-are-getting-better.xlsx
    fig01_scatterplot-talk-length-vs-interest.png
    fig02_histogram-talk-attendance.png
    1986-01-28_raw-data-from-challenger-o-rings.txt
:::

## Principios para los nombres (de los archivos)

::: incremental
1.  Legible por máquinas

    -   Expresiónes regulares (Regex) y globbing[^1] amigable.
        -   Evitar espacios, puntuación, caracteres acentuados y distinción entre mayúsculas y minúsculas.
    -   Fácil de computar.
        -   Uso deliberado de delimitadores: "\_" para delimitar unidades de metadatos y "-" para delimitar palabras

2.  Legible por humanos

    -   El nombre contiene información sobre el contenido.

    -   Relacionado al concepto de URL semántica[^2].

3.  Funciona bien con el orden predeterminado (alfanúmerico)

    -   Poner algo numérico primero.

    -   Utilice la norma ISO 8601 para fechas.

    -   Utilice ceros a la izquierda de otros números.
:::

[^1]: Definir uno o más patrones globales y generar archivos a partir de coincidencias inclusivas o exclusivas. [Fuente](https://learn.microsoft.com/en-us/dotnet/core/extensions/file-globbing)

[^2]: URLs que son entendibles para el usuario. [Fuente](https://es.wikipedia.org/wiki/URL_semántica)

## Ejemplos

::: columns
::: {.column .fragment width="50%" fragment-index="1"}
### Orden lógico

::: {.fragment fragment-index="1" style="font-size: 70px"}
    01_marshal-data.R
    02_pre-dea-filtering.R
    03_dea-with-Limma-voom.R
    04_explore-dea-results.R
    90_Limma-model-term-name-fiasco.R
    helper01_load-counts.R
    helper02_load-exp-des.R
    helper03_load-focus-statinf.R
    helper04_extract-and-tidy.R
:::
:::

::: {.column .fragment width="50%" fragment-index="2"}
### Orden crónologico

::: {.fragment fragment-index="2" style="font-size: 70px"}
    2015-11-09_package-installation.R
    2016-05-21_package-installation.R
    2017-09-05_package-installation.R
    2018-06-29_package-installation.R
    2019-02-19_repair-default-library.R
    2020-06-06_record-existing-pkgs.R
    2021-06-15_git-config-analysis.R
    2021-08-29-git-default-branch.R
    2022-08-11_record-existing-pkgs.R
:::
:::
:::

\

### Ejemplo más complejo {.fragment fragment-index="3"}

::: {.fragment fragment-index="3" style="font-size: 70px"}
    2013-06-26_BRAFWTNEGASSAY_Plasmid-Cellline-100-1MutantFraction_HO1.csv
    2013-06-26_BRAFWTNEGASSAY_Plasmid-Cellline-100-1MutantFraction_HO2.csv
    2013-06-26_BRAFWTNEGASSAY_Plasmid-Cellline-100-1MutantFraction_plateflle.csv
    2014-02-26_BRAFWTNEGASSAY_FFPEDNA-CRC-1-41_A01.csv
    2014-02-26_BRAFWTNEGASSAY_FFPEDNA-CRC-1-41_A02.csv
:::

## Formatos de los nombres

::: columns
::: {.fragment .column fragment-index="2" width="70%"}
![[Allison Horst](https://allisonhorst.com/everything-else).](images/that_case.jpeg){fig-align="center"}
:::

::: {.column width="30%"}
::: {.incremental fragment-index="1"}
-   flatcase
-   SCREAMINGCASE
-   camelCase
-   PascalCase
-   snake_case
-   SCREAMING_SNAKE_CASE
-   camel_Snake_Case
-   Pascal_Snake_Case
-   kebab-case
-   SCREAMING-KEBAB-CASE
-   camel-Kebad-Case
-   Pascal-Kebad-Case
:::
:::
:::

## Estructura de un proyecto

::: columns
::: {.column width="50%"}
:::

::: {.column width="50%"}
:::
:::

## Reportes con Quarto

## Formato de los archivos

## Entornos reproducibles

## `renv`

## Paquetes de R

## Control de versione
